<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Valida√ß√£o Email - Bug</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .teste { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .erro { background-color: #ffebee; border-color: #f44336; }
        .sucesso { background-color: #e8f5e8; border-color: #4caf50; }
        .resultado { margin-top: 5px; font-weight: bold; }
    </style>
</head>
<body>
    <h1>Teste de Valida√ß√£o de Email - Bug Reportado</h1>
    
    <div id="resultados"></div>

    <script>
        // Fun√ß√£o de valida√ß√£o CORRIGIDA (copiada do script.js atualizado)
        function validarEmail(email) {
            console.log(`üß™ Validando email: "${email}"`);
            
            // Verifica se est√° vazio
            if (!email || email.trim() === '') {
                console.log(`‚ùå Email vazio ou apenas espa√ßos`);
                return { valido: false, mensagem: "Digite um E-mail v√°lido" };
            }
            
            // Regex mais rigoroso para valida√ß√£o de email
            // Aceita apenas: nome@dominio.com ou nome@dominio.com.br (sem caracteres extras)
            const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.(com|com\.br)$/;
            
            // Verifica se o email termina exatamente no padr√£o esperado
            if (!emailRegex.test(email)) {
                console.log(`‚ùå Email n√£o passou no regex: ${email}`);
                return { valido: false, mensagem: "Digite um E-mail v√°lido" };
            }
            
            // Verifica se h√° caracteres extras ap√≥s o dom√≠nio
            const partes = email.split('@');
            if (partes.length !== 2) {
                console.log(`‚ùå Email n√£o tem exatamente um @`);
                return { valido: false, mensagem: "Digite um E-mail v√°lido" };
            }
            
            const dominio = partes[1];
            if (dominio.length < 3 || !dominio.includes('.')) {
                console.log(`‚ùå Dom√≠nio inv√°lido: ${dominio}`);
                return { valido: false, mensagem: "Digite um E-mail v√°lido" };
            }
            
            // Verifica se n√£o h√° caracteres extras ap√≥s o dom√≠nio
            const dominioPartes = dominio.split('.');
            if (dominioPartes.length < 2) {
                console.log(`‚ùå Dom√≠nio sem extens√£o`);
                return { valido: false, mensagem: "Digite um E-mail v√°lido" };
            }
            
            // Verifica se a extens√£o √© exatamente .com ou .com.br
            const extensao = dominioPartes.slice(-2).join('.');
            if (extensao !== 'com' && extensao !== 'com.br') {
                console.log(`‚ùå Extens√£o inv√°lida: ${extensao}`);
                return { valido: false, mensagem: "Digite um E-mail v√°lido" };
            }
            
            // Verifica se n√£o h√° caracteres extras ap√≥s a extens√£o
            if (dominioPartes.length > 2 && extensao === 'com') {
                console.log(`‚ùå Caracteres extras ap√≥s extens√£o .com`);
                return { valido: false, mensagem: "Digite um E-mail v√°lido" };
            }
            
            // NOVA VALIDA√á√ÉO: Verifica se h√° caracteres extras ap√≥s o final do email
            // Remove espa√ßos em branco e verifica se o email termina exatamente no dom√≠nio
            const emailLimpo = email.trim();
            const emailSemExtras = emailLimpo.replace(/\.(com|com\.br)$/, '');
            const dominioEsperado = emailLimpo.substring(emailLimpo.lastIndexOf('@') + 1);
            
            // Verifica se o dom√≠nio termina exatamente com .com ou .com.br
            if (!dominioEsperado.endsWith('.com') && !dominioEsperado.endsWith('.com.br')) {
                console.log(`‚ùå Dom√≠nio n√£o termina com .com ou .com.br: ${dominioEsperado}`);
                return { valido: false, mensagem: "Digite um E-mail v√°lido" };
            }
            
            // Verifica se h√° caracteres extras ap√≥s a extens√£o final
            const ultimoPonto = emailLimpo.lastIndexOf('.');
            const extensaoFinal = emailLimpo.substring(ultimoPonto);
            
            if (extensaoFinal !== '.com' && extensaoFinal !== '.com.br') {
                console.log(`‚ùå Caracteres extras ap√≥s extens√£o: ${extensaoFinal}`);
                return { valido: false, mensagem: "Digite um E-mail v√°lido" };
            }
            
            // Verifica se o email n√£o tem caracteres extras ap√≥s a extens√£o final
            const posicaoExtensao = emailLimpo.lastIndexOf(extensaoFinal);
            if (posicaoExtensao + extensaoFinal.length !== emailLimpo.length) {
                console.log(`‚ùå Caracteres extras ap√≥s a extens√£o final`);
                return { valido: false, mensagem: "Digite um E-mail v√°lido" };
            }
            
            console.log(`‚úÖ Email v√°lido: ${email}`);
            return { valido: true, mensagem: "" };
        }

        // Emails para testar
        const emailsTeste = [
            'saraanadao16@gmail.comjdbcijwb', // Bug reportado
            'saraanadao16@gmail.com', // V√°lido
            'saraanadao16@gmail.com.br', // V√°lido
            'teste@hotmail.comjjj', // Sequ√™ncia repetida
            'teste@hotmail.comkkk', // Sequ√™ncia repetida
            'teste@hotmail.comlll', // Sequ√™ncia repetida
            'teste@hotmail.comqjwbgdqw', // Aleat√≥rio
            'teste@hotmail.com123', // N√∫meros
            'teste@hotmail.comabc', // Letras
            'teste@hotmail.com.br', // V√°lido
            'teste@hotmail.com.brxyz', // Extras ap√≥s .br
        ];

        function executarTestes() {
            const container = document.getElementById('resultados');
            
            emailsTeste.forEach(email => {
                const resultado = validarEmail(email);
                const div = document.createElement('div');
                div.className = `teste ${resultado.valido ? 'sucesso' : 'erro'}`;
                
                div.innerHTML = `
                    <strong>Email:</strong> ${email}<br>
                    <div class="resultado ${resultado.valido ? 'sucesso' : 'erro'}">
                        ${resultado.valido ? '‚úÖ V√ÅLIDO' : '‚ùå INV√ÅLIDO'}: ${resultado.mensagem}
                    </div>
                `;
                
                container.appendChild(div);
            });
        }

        // Executar testes quando a p√°gina carregar
        window.onload = executarTestes;
    </script>
</body>
</html>
